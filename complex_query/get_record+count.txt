SELECT IPC.CLASS_CODE, IPC.CLASS_NAME,
IPT.POLICY_TYPE_CODE, 
COUNT(IPT.POLICY_TYPE_CODE) 
FROM 
INS_ASSORTED IA,
INS_DOCUMENT_TYPE IDT,
INS_POLICY_CLASS IPC, 
INS_POLICY_TYPES IPT 
WHERE 
IA.POLICY_TYPE_CODE = IPT.POLICY_TYPE_CODE 
AND 
IPT.CLASS_CODE = IPC.CLASS_CODE
AND 
IA.DOCUMENT_CODE = IDT.DOCUMENT_CODE
AND 
IA.DOCUMENT_CODE IN
(SELECT IA.DOCUMENT_CODE
FROM INS_ASSORTED IA 
WHERE IA.DOCUMENT_CODE = '04')
AND IA.ENT_DATE IN
(SELECT IA.ENT_DATE
FROM 
INS_ASSORTED IA WHERE 
IA.ENT_DATE BETWEEN TRUNC(TO_DATE('01/05/2022','DD/MM/YYYY')) 
AND TRUNC(TO_DATE('31/05/2022','DD/MM/YYYY')))
AND 
IPC.CLASS_CODE IN
(SELECT IPC.CLASS_CODE
FROM INS_POLICY_CLASS IPC 
WHERE IPC.CLASS_CODE IN ('02','03','04')) 
GROUP BY 
IPC.CLASS_CODE, IPC.CLASS_NAME,
IPT.POLICY_TYPE_CODE;  
