==== GET CLASS NAME AND POLICY NAME AND COUNT POLITCY TYPRE CODE === 
SELECT IPC.CLASS_NAME, IPT.POLICY_NAME,
COUNT(IA.POLICY_TYPE_CODE) 
FROM  INS_ASSORTED IA,
INS_POLICY_CLASS IPC,
INS_POLICY_TYPES IPT 
WHERE 
IA.POLICY_TYPE_CODE = IPT.POLICY_TYPE_CODE
AND 
IPT.CLASS_CODE = IPC.CLASS_CODE 
AND 
IA.DOCUMENT_CODE IN 
(SELECT IA.DOCUMENT_CODE
FROM INS_ASSORTED IA 
WHERE IA.DOCUMENT_CODE = '04')
AND IPC.CLASS_NAME NOT IN 
(SELECT IPC.CLASS_NAME FROM INS_POLICY_CLASS IPC 
WHERE IPC.CLASS_NAME IN ('HEALTH','ALL','FIRE','MARINE','MOTOR')
)
AND 
IA.PERIOD_FROM IN 
(SELECT IA.PERIOD_FROM
FROM INS_ASSORTED IA WHERE 
IA.PERIOD_FROM BETWEEN TRUNC(TO_DATE('01/05/2022','DD/MM/YYYY')) AND 
TRUNC(TO_DATE('01/06/2022','DD/MM/YYYY'))) 
GROUP BY IPT.POLICY_TYPE_CODE, IPC.CLASS_NAME, IPT.POLICY_NAME;

