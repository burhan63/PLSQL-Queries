===== Multiple Cursors in Procedure ====
CREATE OR REPLACE PROCEDURE PROC_CURSOR_PR
AS
  emp_id employees.employee_id%type;
  emp_fname employees.first_name%type;
  emp_lname employees.last_name%type;
  emp_email employees.email%type;
  emp_phoneno employees.phone_number%type;
  emp_hiredate employees.hire_date%type;
  depart_id departments.department_id%type;
  depart_name departments.department_name%type;
  job_id jobs.job_id%type;
  job_title jobs.job_title%type;
  total_parent_count number(10);
  total_child_count number(10);
  total_joints_count number(10);

  --Parent Cursor--
  CURSOR C1 IS
  select e.employee_id,e.first_name,e.last_name,e.email,e.phone_number,
  e.hire_date from
  employees e;

  --Child Cursor--
  CURSOR C2 IS
  select e.first_name,e.last_name,e.email,
  d.department_name from
  employees e,
  departments d
  where e.employee_id = d.department_id;

  --Sub Child Cursor--
  CURSOR C3 IS
  select e.first_name,e.last_name,e.email,
  j.job_title,d.department_name from
  employees e,
  jobs j,
  departments d
  where
  e.job_id = j.job_id
  and
  e.employee_id = d.department_id
  and
  d.department_name in( select d.department_name
  from departments d where
  d.department_name like 'C%');


BEGIN
  OPEN C1;
  dbms_output.put_line('==== PARENT CURSOR ==== ' );
  LOOP
    FETCH C1 INTO emp_id,emp_fname,emp_lname,emp_email,
    emp_phoneno,emp_hiredate;
    EXIT WHEN C1%notfound;
    dbms_output.put_line(emp_id || ' ' || emp_fname || ' ' || emp_lname || ' ' ||
                        emp_email || ' ' || emp_phoneno || ' ' || emp_hiredate);
  END LOOP;
  dbms_output.new_line();
  total_parent_count := C1%rowcount;
  dbms_output.put_line('Total Count = ' || total_parent_count);

  OPEN C2;
  dbms_output.new_line();
  dbms_output.put_line('==== CHILD CURSOR ==== ' );
  LOOP
    FETCH C2 INTO emp_fname,emp_lname,emp_email,
    depart_name;
    EXIT WHEN C2%notfound;
    dbms_output.put_line(emp_fname || ' ' || emp_lname || ' ' || emp_email || ' ' ||
                         depart_name);
  END LOOP;
  dbms_output.new_line();
  total_child_count := C2%rowcount;
  dbms_output.put_line('Total Count = ' || total_child_count);
  CLOSE C2;

  OPEN C3;
  dbms_output.new_line();
  dbms_output.put_line('==== SUB CHILD CURSOR ====');
  LOOP
    FETCH C3 INTO emp_fname, emp_lname, emp_email, job_title,
    depart_name;
    EXIT WHEN C3%notfound;
    dbms_output.put_line(emp_fname || ' ' || emp_lname || ' ' || emp_email || ' ' ||
                         job_title || ' ' || depart_name);
  END LOOP;
  dbms_output.new_line();
  total_joints_count := C3%rowcount;
  dbms_output.put_line('Total Count = ' || total_joints_count);


  CLOSE C3;


  CLOSE C1;

END;
